# Numba stencils (or kernels) to smooth data arrays
# (see e.g. https://numba.pydata.org/numba-doc/latest/user/stencil.html)

# import the numba stencil decorator
from numba import stencil


@stencil
def kernel_2D_smooth(arr):
    """
    Smoothing kernel for 2D arrays.
    
    Parameters
    ----------
    arr : 2D array
        The array you want to apply the stencil to.
    
    Returns
    -------
    arr : 2D array
        
    """
    return 3.0 * arr[ 0, 0] \
               + arr[+1, 0] \
               + arr[ 0,+1] \
               + arr[-1, 0] \
               + arr[ 0,-1] \
               + arr[+1,+1] \
               + arr[-1,-1] \
               + arr[+1,-1] \
               + arr[-1,+1]


@stencil
def kernel_1(a, b):
    return 9.0 * a[ 0, 0, 0] * b[ 0, 0, 0] \
               + a[+1, 0, 0] * b[+1, 0, 0] \
               + a[ 0,+1, 0] * b[ 0,+1, 0] \
               + a[ 0, 0,+1] * b[ 0, 0,+1] \
               + a[-1, 0, 0] * b[-1, 0, 0] \
               + a[ 0,-1, 0] * b[ 0,-1, 0] \
               + a[ 0, 0,-1] * b[ 0, 0,-1] \
               + a[+1,+1, 0] * b[+1,+1, 0] \
               + a[ 0,+1,+1] * b[ 0,+1,+1] \
               + a[+1, 0,+1] * b[+1, 0,+1] \
               + a[-1,-1, 0] * b[-1,-1, 0] \
               + a[ 0,-1,-1] * b[ 0,-1,-1] \
               + a[-1, 0,-1] * b[-1, 0,-1] \
               + a[+1,-1, 0] * b[+1,-1, 0] \
               + a[-1,+1, 0] * b[-1,+1, 0] \
               + a[ 0,+1,-1] * b[ 0,+1,-1] \
               + a[ 0,-1,+1] * b[ 0,-1,+1] \
               + a[+1, 0,-1] * b[+1, 0,-1] \
               + a[-1, 0,+1] * b[-1, 0,+1] \
               + a[+1,+1,+1] * b[+1,+1,+1] \
               + a[-1,-1,-1] * b[-1,-1,-1] \
               + a[+1,-1,-1] * b[+1,-1,-1] \
               + a[-1,+1,+1] * b[-1,+1,+1] \
               + a[-1,+1,-1] * b[-1,+1,-1] \
               + a[+1,-1,+1] * b[+1,-1,+1] \
               + a[+1,+1,-1] * b[+1,+1,-1] \
               + a[-1,-1,+1] * b[-1,-1,+1]


@stencil
def kernel_2(b):
    return 9.0 * b[ 0, 0, 0] \
               + b[+1, 0, 0] \
               + b[ 0,+1, 0] \
               + b[ 0, 0,+1] \
               + b[-1, 0, 0] \
               + b[ 0,-1, 0] \
               + b[ 0, 0,-1] \
               + b[+1,+1, 0] \
               + b[ 0,+1,+1] \
               + b[+1, 0,+1] \
               + b[-1,-1, 0] \
               + b[ 0,-1,-1] \
               + b[-1, 0,-1] \
               + b[+1,-1, 0] \
               + b[-1,+1, 0] \
               + b[ 0,+1,-1] \
               + b[ 0,-1,+1] \
               + b[+1, 0,-1] \
               + b[-1, 0,+1] \
               + b[+1,+1,+1] \
               + b[-1,-1,-1] \
               + b[+1,-1,-1] \
               + b[-1,+1,+1] \
               + b[-1,+1,-1] \
               + b[+1,-1,+1] \
               + b[+1,+1,-1] \
               + b[-1,-1,+1]
